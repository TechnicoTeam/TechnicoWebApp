@{
    ViewData["Title"] = "LogIn";
}


    <form id="loginForm" class="p-4 col-4 offset-4 mt-5">
        <h1 class="mb-3 text-center">Login Menu</h1>

        <div class="form-group pb-3">
            <input id="username" type="email" class="form-control" placeholder="Email" required>
        </div>

        <div class="form-group pb-3">
            <input id="password" type="password" class="form-control" placeholder="Password" required>
        </div>

        <button type="submit" class="btn btn-primary pt-3 pb-3 col-4 offset-4">Sign In</button>

        <a class="nav-link text-dark text-center text-decoration-underline" asp-area="" asp-controller="Home" asp-action="Register">Are you not registered?</a>

        <div id="error-message" class="alert alert-danger" style="display:none;"></div>

    </form>


 <script>
     document.getElementById('loginForm').addEventListener('submit', function (e) {
         e.preventDefault();  // Prevent form from submitting the default way

         const username = document.getElementById('username').value;
         const password = document.getElementById('password').value;

         // Create a user object to send to the API
         const user = { username: username, password: password };

         // Perform the AJAX request to your backend API
         fetch('https://localhost:7061/Auth/LogIn', {
             method: 'POST',
             headers: {
                 'Content-Type': 'application/json'
             },
             body: JSON.stringify(user)
         })
             .then(response => {
                 if (!response.ok) {
                     throw new Error('Invalid credentials');
                 }
                 return response.json();  // Parse the response JSON
             })
             .then(data => {
                 // If successful, store the token in localStorage or sessionStorage
                 localStorage.setItem('authToken', data.token);

                 // Redirect user to a protected page (example: Home page)
                 window.location.href = '/Home';
             })
             .catch(error => {
                 // Display error message if login fails
                 document.getElementById('error-message').style.display = 'block';
                 document.getElementById('error-message').textContent = 'Login failed: ' + error.message;
             });
     });
 </script>